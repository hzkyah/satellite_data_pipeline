import csv
from h3 import h3

cali = {
        "type": "Polygon",
        "coordinates": [[
            [ 41.934976500546604 , -124.12353515624999],
            [ 40.413496049701955,  -124.0576171875    ],
            [ 37.26530995561875, -122.29980468749999  ],
            [ 36.63316209558658,   -121.46484375,     ],
            [ 32.89803818160521, -117.13623046874999  ],
            [ 34.361576287484176,     -114.3896484375 ],
            [ 38.993572058209466, -120.03662109374999 ],
            [ 41.96765920367816,   -120.10253906249999],
            [ 41.934976500546604,  -124.12353515624999]
          ]] }

sanfra = {'type': 'Polygon',
        'coordinates': [[
            [37.80490143094975, -122.47352600097658],
            [37.77831314799669, -122.50785827636719],
            [37.71044257039145, -122.49961853027342],
            [37.70555348721583, -122.40829467773436],
            [37.72945260537779, -122.3773956298828],
            [37.80273131752431, -122.40692138671874],
            [37.80490143094975, -122.47352600097658]
        ]] }

SF_geometry = { "type": "Polygon",
                        "coordinates": [[
            [37.80924146650164, -122.47678756713866],
            [37.788624026050876, -122.48760223388672],
            [37.78753873820529,  -122.50562667846678],
            [37.78102667641841, -122.51420974731444],
            [37.7293168367123, -122.50717163085938],
            [37.72877375956114, -122.37533569335936],
            [37.7521224804801, -122.37567901611328],
            [37.78943798147498, -122.38700866699219],
            [37.80856335276034, -122.40280151367188],
            [37.81114015184751, -122.42391586303711],
            [37.80625771945958, -122.44949340820312],
            [37.80490143094975, -122.46288299560545],
            [37.80924146650164, -122.47678756713866]
          ]] }

geoJson = {'type': 'Polygon',
 'coordinates': [[[37.813318999983238, -122.4089866999972145],
 [ 37.7866302000007224, -122.3805436999997056 ],
 [37.7198061999978478, -122.3544736999993603],
 [ 37.7076131999975672, -122.5123436999983966 ],
 [37.7835871999971715, -122.5247187000021967],
 [37.8151571999998453, -122.4798767000009008]]] }

h3_address = h3.geo_to_h3(37.3615593, -122.0553238, 5) # lat, lng, hex resolution
print(h3_address)
hex_center_coordinates = h3.h3_to_geo(h3_address) # array of [lat, lng]
print(hex_center_coordinates)
hex_boundary = h3.h3_to_geo_boundary(h3_address) # array of array of [lat, lng]
#print(hex_boundary)
hexagons_sanf = list(h3.polyfill(SF_geometry, 9)) # resolution 9
print(len(hexagons_sanf))
hexagons_cali = list(h3.polyfill(cali, 8)) # resolution 8
print(len(hexagons_cali))

with open('SF_hex.csv', 'w', newline='') as SFgrids:
    for grid in hexagons_sanf:
        center_coord = h3.h3_to_geo(grid)
        coordwriter = csv.writer(SFgrids, delimiter=',')
        coordwriter.writerow(center_coord)
